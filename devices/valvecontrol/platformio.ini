; PlatformIO Configuration for Valve Controller
; Target: Nordic nRF52832 with BLE, LoRa, and CAN bus
;
; Build targets:
;   pio run -e debug          # Debug build
;   pio run -e release        # Release build

[platformio]
default_envs = debug

; Common settings for all environments
[env]
platform = nordicnrf52
framework = arduino
lib_deps = 
    sandeepmistry/LoRa@^0.8.0
    rweather/Crypto@0.4.0
    adafruit/Adafruit SPIFlash@^4.3.4
    adafruit/Adafruit FRAM SPI@^2.0.0
    https://github.com/autowp/arduino-mcp2515.git
lib_ignore = Wire
extra_scripts = pre:copy_wire_stub.py
upload_protocol = nrfutil
monitor_speed = 115200

; =============================================================================
; DEBUG BUILD - For development
; =============================================================================
[env:debug]
board = adafruit_feather_nrf52832
build_flags = 
    -D NRF52832_XXAA
    -D CFG_us915=1
    -D LORA_FREQUENCY=915E6
    -D DEBUG_BUILD=1
    -D CFG_DEBUG=1
    -O0 -g3
build_type = debug

; =============================================================================
; RELEASE BUILD - For production
; =============================================================================
[env:release]
board = adafruit_feather_nrf52832
build_flags = 
    -D NRF52832_XXAA
    -D CFG_us915=1
    -D LORA_FREQUENCY=915E6
    -D RELEASE_BUILD=1
    -D CFG_DEBUG=0
    -Os
    -DNDEBUG
build_type = release
